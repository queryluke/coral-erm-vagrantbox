---
- hosts: coral.dev
  become: yes
  become_method: sudo
  become_user: root
  gather_facts: yes
  vars:
    apache_vhosts_filename: "{{ project_name }}.conf"
    apache_vhosts:
      - servername: "{{ project_name }}.dev"
        documentroot: "{{ release_path }}"
    mysql_root_password: coralerm
    php_version: '5.6'
    php_memory_limit: "128M"
    php_max_execution_time: "90"
    php_upload_max_filesize: "256M"
    php_packages:
      - php
      - php-cli
      - php-common
      - php-devel
      - php-gd
      - php-mbstring
      - php-pdo
      - php-pecl-apcu
      - php-xml
      - php-pear
      - php-mysql
  roles:
    - role: basic-setup
    - role: geerlingguy.apache
    - role: geerlingguy.repo-remi
      when: ansible_os_family == 'RedHat'
    - role: geerlingguy.php-versions
    - role: geerlingguy.php
    - role: geerlingguy.mysql
  tasks:
    - name: disable selinux
      command: setenforce 0
    - name: install composer
      shell: |
        cd /tmp
        curl -sS https://getcomposer.org/installer | php
        mv composer.phar /usr/local/bin/composer


